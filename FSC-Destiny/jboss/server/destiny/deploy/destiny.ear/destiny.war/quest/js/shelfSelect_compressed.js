Class.create({initialize:function(d){var c=Object.extend({id:"searchtemplate",shelfNumber:null},d);if($(c.id)){var a=Utility.selectByClass($(c.id),"myQuestShelfControlWrapper");for(var f=0;f<a.length;f++){var h=Utility.selectByClass(a[f],"linkHoverShelfOption");var e=Utility.selectByClass(a[f],"linkHoverShelfSelect");var g=Utility.selectByClass(a[f],"myQuestShelfControlHeader");var b=a[f].up().down(".currentID");if(b){b=b.innerHTML}if(c.shelfNumber&&null!=c.shelfNumber&&""!=c.shelfNumber){this.updateSelected(b,h,e,c.shelfNumber)}Event.observe(h[0],"click",this.handleChange.bind(this,a[f],h,e,0));Event.observe(h[1],"click",this.handleChange.bind(this,a[f],h,e,1));Event.observe(h[2],"click",this.handleChange.bind(this,a[f],h,e,2));Event.observe(g[0],"mousedown",this.showOptions.bind(this,a[f]));Event.observe(a[f],"mouseout",this.triggerHideOptions.bind(this,a[f]));Event.observe(a[f],"mouseover",this.stopTriggerHideOptions.bind(this,a[f]));a[f].hoverTimeout=null}}},handleChange:function(g,f,d,c){var b=g.readAttribute("bibID");
var a=f[c].readAttribute("shelfNumber");var e={bibID:b,shelfNumber:a};if(!f[c].hasClassName("selected")){this.updateSelected(b,f,d,c);this.updateShelfNumberOnBib(b,a);this.hideOptions(g);DAO.load({endpoint:"MyQuestShelfController.ShelfAdd",container:null},b,a);if(!window.shelfStuff){window.shelfStuff=[]}window.shelfStuff[b]=a}return false},updateCacheHTML:function(c,b,a){},updateShelfNumberOnBib:function(c,b){var a=$$(".recordID[value='"+c+"']");for(var d=0;d<a.length;d++){a[d].next(".shelfNumber").setAttribute("value",b)}},updateSelected:function(c,g,f,d){var b=$$(".recordID[value='"+c+"']");for(var e=0;e<b.length;e++){var a=b[e].up().down(".myQuestShelfControlWrapper");if(a){var h=Utility.selectByClass(a,"linkHoverShelfOption");this._updateSingleSelected(h,a.down().down(),d)}}this._updateSingleSelected(g,f[0],d)},_updateSingleSelected:function(c,b,a){c[0].removeClassName("selected");c[1].removeClassName("selected");c[2].removeClassName("selected");b.update(c[a].down().down().innerHTML+"<em></em>");
c[a].addClassName("selected")},showOptions:function(b){if(b){var a=b.down("ul");if(a&&!a.visible()){Effect.BlindDown(a,{duration:0.25})}}return false},hideOptions:function(b){if(b){var a=b.down("ul");if(a&&a.visible()){Effect.BlindUp(a,{duration:0.25});b.hoverTimeout=null}}},triggerHideOptions:function(a){if(!a.hoverTimeout){a.hoverTimeout=this.hideOptions.bind(this,a).delay(0.25)}},stopTriggerHideOptions:function(a){if(a.hoverTimeout){window.clearTimeout(a.hoverTimeout);a.hoverTimeout=null}}});