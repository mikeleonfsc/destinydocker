Class.create(BaseController,{init:function(){var c=Registry.lookup("QuestErrorController.Loader");if(c&&c.hasErrors()&&!c.sideWidgetsLoaded){c.sideWidgetsLoaded=true;PostLoadBootstrapper.load(["BooklistWidgetController.Load","MyQuestController.MyShelves"])}var b=Registry.lookup("OneSearchController.SearchMaster");if(this.data.warningMessage){b.setWarningMessage(this.data.warningMessage)}if(this.data.errorMessage){b.setErrorMessage(this.data.errorMessage)}else{b.setCountMessage(this.data.countMessage);if(!this.data.oneSearchResult.listComplete){b.startRefreshTimer()}else{b.hideLoadingGraphic()}}if(this.data.limiters&&Object.isArray(this.data.limiters.limiterMenu)){Registry.createController("LimiterController.Limiters",this.data.limiterTemplateURL,this.data.limiterControllerURL,{endpoint:"LimiterController.Limiters",container:$(LimiterController_DIV_LIMITER_OUTER)},this.data.limiters)}var a=Registry.lookup("LimiterController.History");a.getNarrowingHistory()},dataAppended:function(c){var b=this.pagedData[0];
var d=this.pagedData[1];var a=b.oneSearchResult.results;if(d){var e=d.oneSearchResult.results;if(Object.isArray(a)&&Object.isArray(e)){a=a.concat(e)}}this.data=Object.extend(b,d);if(this.data.limiters&&Object.isArray(this.data.limiters.limiterMenu)){Registry.createController("LimiterController.Limiters",this.data.limiterTemplateURL,this.data.limiterControllerURL,{endpoint:"LimiterController.Limiters",container:$(LimiterController_DIV_LIMITER_OUTER)},this.data.limiters)}this.data.oneSearchResult.results=a;this.pagedData=[this.data];this.currentPage=null;this.setPage(0)},registerEvents:function(){for(var a=0;a<this.data.oneSearchResult.results.length;a++){var b=this.data.oneSearchResult.results[a];var c=this.loadOneSearchDetails.bind(this);Event.observe(this.elementMap.get("oneseachDatabaseRow_"+(b.vopacRecDisplayID-1)),"mousedown",c.curry(b.vopacRecDisplayID))}},loadOneSearchDetails:function(c){var a=Registry.lookup("OneSearchController.Dialog");if(!a){var d={id:OneSearchController_DIV_ONESEARCH_DBDETAIL_DIALOG,zIndex:"50000",hideOnOutsideClick:"true"};
var b=new ModalDialog(d);DAO.load({endpoint:"OneSearchController.Dialog",modal:b},c)}else{a.loadDatabase(c)}}});