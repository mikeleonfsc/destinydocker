Class.create(BaseController,{init:function(){var a=Registry.lookup("ResourceListController.Master");if(this.data.message){var c=Registry.lookup("ResourceListEmailController.Dialog");if(this.data.successMsg){c.modal.animatedSubmit(this.data.successMsg,2)}else{var b=c.elementMap.get(ResourceListEmailController_DIV_EMAIL_OPTIONS_ERROR_MESSAGE);b.update(this.data.message);b.show();c.elementMap.get(ResourceListEmailController_BUTTON_EMAIL_OPTIONS_SEND).show();c.elementMap.get(ResourceListEmailController_IMG_SEND_EMAIL_IN_PROGRESS).hide()}}else{this.elementMap.get(ResourceListEmailController_INPUT_EMAIL_OPTIONS_DISPLAY_NAME).setValue(this.data.displayName);this.elementMap.get(ResourceListEmailController_INPUT_EMAIL_OPTIONS_DISPLAY_NAME).focus();this.elementMap.get(ResourceListEmailController_INPUT_EMAIL_OPTIONS_ADDRESS).setValue(this.data.emailAddress);this.elementMap.get(ResourceListEmailController_INPUT_EMAIL_OPTIONS_SUBJECT).setValue(a.getListNameForEmail());this.elementMap.get(ResourceListEmailController_IMG_SEND_EMAIL_IN_PROGRESS).hide();
this.modal.show()}},registerEvents:function(){if(!this.data.message){Event.observe(this.elementMap.get(ResourceListEmailController_BUTTON_EMAIL_OPTIONS_CLOSE),"mousedown",this.closeDialog.bind(this));Event.observe(this.elementMap.get(ResourceListEmailController_BUTTON_EMAIL_OPTIONS_SEND),"mousedown",this.sendEmail.bind(this))}},closeDialog:function(){this.modal.closeDialog()},sendEmail:function(){var c=Registry.lookup("ResourceListController.Master");var e=c.getCollectionType();var b=c.getListID();var a=this.elementMap.get(ResourceListEmailController_INPUT_EMAIL_OPTIONS_DISPLAY_NAME).getValue();var h=this.elementMap.get(ResourceListEmailController_INPUT_EMAIL_OPTIONS_ADDRESS).getValue();var d=this.elementMap.get(ResourceListEmailController_INPUT_EMAIL_OPTIONS_SUBJECT).getValue();var f=this.elementMap.get(ResourceListEmailController_INPUT_EMAIL_OPTIONS_MESSAGE).getValue();var g=this.elementMap.get(ResourceListEmailController_DIV_EMAIL_OPTIONS_ERROR_MESSAGE);a=a.strip();h=h.strip();d=d.strip();
if(a.empty()||h.empty()||d.empty()){g.update(MessageHelper.format("resourceListEmailController_youMustProvideADisplayName"));g.show()}else{g.update("");g.hide();this.elementMap.get(ResourceListEmailController_BUTTON_EMAIL_OPTIONS_SEND).hide();this.elementMap.get(ResourceListEmailController_IMG_SEND_EMAIL_IN_PROGRESS).show();DAO.load({endpoint:"ResourceListEmailController.SendEmail",method:"post"},e,b,a,h,d,f)}}});